<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This package provides functions to obtain surrogate splits
    applying ranger for random forests generation and using modified
    functions from the package rpart. Surrogate variables and
    corresponding adjusted agreement values are used for surrogate minimal
    depth variable importance and to investigate variable relations.">
<title>Surrogate Minimal Depth Variable Importance • RFSurrogates</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Surrogate Minimal Depth Variable Importance">
<meta property="og:description" content="This package provides functions to obtain surrogate splits
    applying ranger for random forests generation and using modified
    functions from the package rpart. Surrogate variables and
    corresponding adjusted agreement values are used for surrogate minimal
    depth variable importance and to investigate variable relations.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">RFSurrogates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AGSeifert/RFSurrogates/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rfsurrogates">RFSurrogates<a class="anchor" aria-label="anchor" href="#rfsurrogates"></a>
</h1></div>
<p>In this R package, several functions are provided for applying approaches based on random forest. Minimal depth (MD), Surrogate minimal depth (SMD) and mutual impurity reduction (MIR), which is a corrected approach of SMD, can be applied to assess the importance of variables and to select important variables. In addition, the parameters mean adjusted agreement and mutual forest impact (MFI), a corrected approach of the previous, can be applied to investigate variable relations based on surrogate variables.</p>
<p>Please cite the following manuscripts if you use the package:</p>
<p>[1] S. Seifert, S. Gundlach, S. Szymczak, Surrogate minimal depth as an importance measure for variables in random forests, Bioinformatics 2019, 35, 3663-3671. [<a href="https://doi.org/10.1093/bioinformatics/btz149" class="external-link">doi:10.1093/bioinformatics/btz149</a>]</p>
<p>[2] publication about MFI/MIR under preparation [<a href="https://doi.org/10.48550/ARXIV.2304.02490" class="external-link">arXiv Preprint</a>]</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"AGSeifert/RFSurrogates"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="example-data-doi">Example Data <a href="https://doi.org/10.25592/uhhfdm.12620" class="external-link"><img src="https://www.fdr.uni-hamburg.de/badge/DOI/10.25592/uhhfdm.12620.svg" alt="DOI"></a>
<a class="anchor" aria-label="anchor" href="#example-data-doi"></a>
</h1>
<p>The package contains an example data set which consists of a single replicate of the simulation study 1 in publication [1]. Please refer to the paper and the documentation of the SMD_example_data for further details on the simulation scenario. The R script for the simulation is published <a href="https://doi.org/10.25592/uhhfdm.12620" class="external-link">here</a>.</p>
</div>
<div class="section level1">
<h1 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h1>
<p>First the package and the example data are loaded:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://agseifert.github.io/RFSurrogates/">RFSurrogates</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SMD_example_data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">SMD_example_data</span><span class="op">)</span></span>
<span><span class="co"># [1] 100 201</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SMD_example_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#            y          X1         X2         X3           X4</span></span>
<span><span class="co"># 1  1.8222421 -0.02768266 -1.1019154  2.2659401  0.008021516</span></span>
<span><span class="co"># 2 -1.0401813  0.73258486 -0.4107975  0.7587792 -0.718752746</span></span>
<span><span class="co"># 3  2.7139607 -0.05399936  1.1851261  0.9743160 -2.563176970</span></span>
<span><span class="co"># 4 -0.7081372 -0.84838121 -0.8975802  0.5247899  1.180683275</span></span>
<span><span class="co"># 5 -1.0264429 -0.42219003  0.5439467 -0.1626504  0.682333020</span></span>
<span><span class="co"># 6  3.1871209  0.91722598  0.1974106  0.9571554  0.351634641</span></span></code></pre></div>
<p>The data set has 100 observations in the rows and the columns contain the continuous outcome variable y and 200 continuous predictor variables in the columns.</p>
<div class="section level2">
<h2 id="minimal-depth-md">Minimal Depth (MD)<a class="anchor" aria-label="anchor" href="#minimal-depth-md"></a>
</h2>
<p>First, we perform variable selection based on minimal depth using 1000 trees in the random forest. To make the analysis reproducible we set the seed first.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">res.md</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/var.select.md.html">var.select.md</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">SMD_example_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">SMD_example_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, </span>
<span>  num.trees <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res.md</span><span class="op">$</span><span class="va">var</span></span>
<span><span class="co"># [1] "X2"     "X3"     "X4"     "X5"     "X6"     "cp1_8" </span></span>
<span><span class="co"># [7] "cp2_1"  "cp2_6"  "cp2_7"  "cp3_4"  "cp3_6"  "cgn_20"</span></span>
<span><span class="co"># [13] "cgn_68" "cgn_72" "cgn_81"</span></span></code></pre></div>
<p>The selected variables are stored in <code>res.md$var</code>. In this analysis the relevant basic variables <code>"X2"</code> to <code>"X6"</code>, as well as the relevant variables <code>"cp1_8"</code>, <code>"cp2_1"</code>, <code>"cp2_6"</code>, <code>"cp2_7"</code>, <code>"cp3_4"</code>, and <code>"cp3_6"</code>, and the non-relevant variables <code>"cgn_20"</code>, <code>"cgn_68"</code>, <code>"cgn_72"</code>, and <code>"cgn_81"</code> are selected.</p>
<p>The MD values for each predictor variable and the threshold to select variables can be extracted as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">md</span> <span class="op">&lt;-</span> <span class="va">res.md</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">depth</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">md</span><span class="op">)</span></span>
<span><span class="co">#    X1    X2    X3    X4    X5    X6 </span></span>
<span><span class="co"># 9.743 7.907 6.155 6.615 6.456 6.428 </span></span>
<span></span>
<span><span class="va">res.md</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">threshold</span></span>
<span><span class="co"># [1] 9.230328</span></span></code></pre></div>
<p>We can see that variables <code>"X2"</code>, …, <code>"X6"</code> have MD values smaller than the threshold in contrast to <code>"X1"</code>.</p>
</div>
<div class="section level2">
<h2 id="surrogate-minimal-depth-smd">Surrogate Minimal Depth (SMD)<a class="anchor" aria-label="anchor" href="#surrogate-minimal-depth-smd"></a>
</h2>
<p>Now we would like to analyze the example data with surrogate minimal depth which works similarly. However, we need to specify an additional parameter <code>s</code>, the number of surrogate variables that should be considered. In this analysis we use <code>s = 10</code>. Based on our simulation studies we recommend to set this parameter to approximately 1% of the predictor variables in larger datasets.</p>
<p>Variable selection with var.select.smd is conducted:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">res.smd</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/var.select.smd.html">var.select.smd</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">SMD_example_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">SMD_example_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, </span>
<span>  s <span class="op">=</span> <span class="fl">10</span>, num.trees <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res.smd</span><span class="op">$</span><span class="va">var</span></span>
<span><span class="co">#  [1] "X1"     "X2"     "X3"     "X4"     "X5"     "X6"    </span></span>
<span><span class="co">#  [7] "X7"     "X8"     "cp1_1"  "cp1_2"  "cp1_3"  "cp1_4" </span></span>
<span><span class="co"># [13] "cp1_5"  "cp1_6"  "cp1_7"  "cp1_8"  "cp1_9"  "cp1_10"</span></span>
<span><span class="co"># [19] "cp2_1"  "cp2_3"  "cp2_4"  "cp2_6"  "cp2_7"  "cp2_9" </span></span>
<span><span class="co"># [25] "cp2_10" "cp3_4" </span></span></code></pre></div>
<p>The selected variables are stored in <code>res.smd$var</code>. In this analysis the relevant basic variables <code>"X1"</code> to <code>"X6"</code>, as well as the relevant variables <code>"cp1_1"</code> to <code>"cp1_10"</code>, <code>"cp2_1"</code>, <code>"cp2_3"</code>, <code>"cp2_4"</code>, <code>"cp2_6"</code> through <code>"cp2_10"</code>, and <code>"cp3_4"</code> are selected. Compared to MD more of the relevant variables and none of the non-relevant variables are selected.</p>
<p>The SMD values for each predictor variable and the threshold to select variables can be extracted as follows:</p>
<pre><code><span><span class="va">smd</span> <span class="op">=</span> <span class="va">res.smd</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">depth</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">smd</span><span class="op">)</span></span>
<span><span class="co">#    X1    X2    X3    X4    X5    X6 </span></span>
<span><span class="co"># 2.112 2.085 1.806 2.208 2.148 2.014 </span></span>
<span></span>
<span><span class="va">res.smd</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">threshold</span></span>
<span><span class="co"># [1] 2.671644</span></span></code></pre>
<p>We can see that variables <code>"X1"</code>, …, <code>"X6"</code> have SMD values smaller than the threshold.</p>
</div>
<div class="section level2">
<h2 id="variable-relations-based-on-the-mean-adjusted-agreement-of-surrogate-variables">Variable relations based on the mean adjusted agreement of surrogate variables<a class="anchor" aria-label="anchor" href="#variable-relations-based-on-the-mean-adjusted-agreement-of-surrogate-variables"></a>
</h2>
<p>Now we want to investigate the relations of variables. We would like to identify which of the first 100 predictor variables are related to <code>"X1"</code> and <code>"X7"</code>. We simulated 10 correlated predictor variables for each of these two basic variables. One possibility to investigate variable relations is to use the results from <code><a href="reference/var.select.smd.html">var.select.smd()</a></code>. Hence, first SMD is conducted like in the <a href="#surrogate-minimal-depth-smd">previous section</a>.</p>
<p>Subsequently, variable relations are analyzed with <code><a href="reference/var.relations.html">var.relations()</a></code>. The parameter <code>t</code> can be adapted to either focus on strongly related variables only (high numbers) or to include also moderately related variables (low numbers):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">candidates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">SMD_example_data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span></span>
<span><span class="va">rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/var.relations.html">var.relations</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>, create.forest <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  forest <span class="op">=</span> <span class="va">res.smd</span><span class="op">$</span><span class="va">forest</span>, </span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X7"</span><span class="op">)</span>, candidates <span class="op">=</span> <span class="va">candidates</span>, </span>
<span>  t <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rel</span><span class="op">$</span><span class="va">var</span></span>
<span><span class="co"># $X1</span></span>
<span><span class="co">#  [1] "cp1_1"  "cp1_2"  "cp1_3"  "cp1_4"  "cp1_5"  "cp1_6" </span></span>
<span><span class="co">#  [7] "cp1_7"  "cp1_8"  "cp1_9"  "cp1_10"</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $X7</span></span>
<span><span class="co">#  [1] "cp7_1"  "cp7_2"  "cp7_3"  "cp7_4"  "cp7_5"  "cp7_6" </span></span>
<span><span class="co">#  [7] "cp7_7"  "cp7_8"  "cp7_9"  "cp7_10"</span></span></code></pre></div>
<p>All of the variables that are correlated to <code>"X1"</code> are correctly identified as related to <code>"X1"</code> and all of the variables that are correlated to <code>"X7"</code> are correctly identified as related to <code>"X7"</code>.</p>
</div>
<div class="section level2">
<h2 id="variable-relations-based-on-mutual-forest-impact-mfi">Variable relations based on Mutual Forest Impact (MFI)<a class="anchor" aria-label="anchor" href="#variable-relations-based-on-mutual-forest-impact-mfi"></a>
</h2>
<p>MFI is a corrected relation parameter calculated by the mean adjusted agreement of the variables and permuted versions of them. Related variables are selected by p-values obtained from a null distribution either determined by negative relation scores (based on the Janitza approach) or by permuted relations. We use the default parameters for the selection here, which is a p-values threshold of 0.01 and the Janitza approach.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">rel.mfi</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/var.relations.mfi.html">var.relations.mfi</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">SMD_example_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">SMD_example_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, </span>
<span>  s <span class="op">=</span> <span class="fl">10</span>, num.trees <span class="op">=</span> <span class="fl">1000</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X7"</span><span class="op">)</span>,</span>
<span>  candidates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">SMD_example_data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span>, </span>
<span>  p.t <span class="op">=</span> <span class="fl">0.01</span>, method <span class="op">=</span> <span class="st">"janitza"</span>, num.threads <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rel.mfi</span><span class="op">$</span><span class="va">var.rel</span></span>
<span><span class="co"># $X1</span></span>
<span><span class="co">#  [1] "cp1_1"  "cp1_2"  "cp1_3"  "cp1_4"  "cp1_5"  "cp1_6" </span></span>
<span><span class="co">#  [7] "cp1_7"  "cp1_8"  "cp1_9"  "cp1_10"</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $X7</span></span>
<span><span class="co">#  [1] "cp7_1"  "cp7_2"  "cp7_3"  "cp7_4"  "cp7_5"  "cp7_6" </span></span>
<span><span class="co">#  [7] "cp7_7"  "cp7_8"  "cp7_9"  "cp7_10"</span></span></code></pre></div>
<p>Also by MFI, all of the variables that are correlated to <code>"X1"</code> are correctly identified as related to <code>"X1"</code> and all of the variables that are correlated to <code>"X7"</code> are correctly identified as related to <code>"X7"</code>. Also the matrix of determined relation (<code>surr.res</code>), permuted relations (<code>surr.perm</code>) and determined p-values (<code>p.rel</code>) can be extracted as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MFI</span> <span class="op">&lt;-</span> <span class="va">rel.mfi</span><span class="op">$</span><span class="va">surr.res</span></span>
<span><span class="va">surr.perm</span> <span class="op">&lt;-</span> <span class="va">rel.mfi</span><span class="op">$</span><span class="va">surr.perm</span></span>
<span><span class="va">p.rel</span> <span class="op">&lt;-</span> <span class="va">rel.mfi</span><span class="op">$</span><span class="va">p.rel</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mutual-impurity-reduction-mir">Mutual Impurity Reduction (MIR)<a class="anchor" aria-label="anchor" href="#mutual-impurity-reduction-mir"></a>
</h2>
<p>Now we would like to analyze the example data with MIR, which determines the variable importance by the actual impurity reduction combined with the relations determined by MFI. Different to MD and SMD, this approach calculates p-values for the selection of important variables. For this, the null distribution is obtained in a similar way as for MFI, either by negative importance scores called the Janitza approach or by permutation. Since this example data set is comparatively small, we use the permutation approach. As a threshold for selection a value of 0.01 is applied (<code>p.t.sel = 0.01</code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">res.mir</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/var.select.mir.html">var.select.mir</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">SMD_example_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">SMD_example_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, </span>
<span>  s <span class="op">=</span> <span class="fl">10</span>, num.trees <span class="op">=</span> <span class="fl">1000</span>, method.sel <span class="op">=</span> <span class="st">"permutation"</span>,</span>
<span>  p.t.sel <span class="op">=</span> <span class="fl">0.01</span>, num.threads <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res.mir</span><span class="op">$</span><span class="va">var</span></span>
<span><span class="co">#  [1] "X1"     "X2"     "X3"     "X4"     "X5"     "X6"    </span></span>
<span><span class="co">#  [7] "cp1_1"  "cp1_2"  "cp1_3"  "cp1_4"  "cp1_5"  "cp1_6" </span></span>
<span><span class="co"># [13] "cp1_7"  "cp1_8"  "cp1_9"  "cp1_10" "cp2_1"  "cp2_3" </span></span>
<span><span class="co"># [19] "cp2_4"  "cp2_6"  "cp2_7"  "cp2_10" "cp3_1"  "cp3_4" </span></span>
<span><span class="co"># [25] "cp3_5"  "cgn_72" "cgn_81"</span></span></code></pre></div>
<p>The selected variables are stored in <code>res.mir$var</code>. Here, the relevant variables <code>"cp1_1"</code> to <code>"cp1_10"</code>, <code>"cp2_1"</code>, <code>"cp2_3"</code>, <code>"cp2_4"</code>, <code>"cp2_6"</code>, <code>"cp2_7"</code>, <code>"cp2_10"</code>, <code>"cp3_1"</code>, <code>"cp3_4"</code>, <code>"cp3_5"</code>, as well as the non-relevant variables <code>"cgn_72"</code> and <code>"cgn_81"</code> are selected.</p>
<p>The MIR values and p-values can be extracted as follows:</p>
<pre><code><span><span class="va">mir</span> <span class="op">&lt;-</span> <span class="va">res.mir</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">MIR</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mir</span><span class="op">)</span></span>
<span><span class="co">#       X1       X2       X3       X4       X5       X6 </span></span>
<span><span class="co"># 10.68243 15.95674 27.09036 20.50233 23.16293 21.15731</span></span>
<span></span>
<span><span class="va">pvalues</span> <span class="op">&lt;-</span> <span class="va">res.mir</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">pvalue</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pvalues</span><span class="op">)</span></span>
<span><span class="co"># X1 X2 X3 X4 X5 X6 </span></span>
<span><span class="co">#  0  0  0  0  0  0 </span></span></code></pre>
<p>We can see that variables <code>"X1"</code>, …, <code>"X6"</code> have a p-value of 0 and are selected.</p>
<p>Since this approach is based on the actual impurity reduction combined with the relations determined by MFI, both of these can also be extracted from the results:</p>
<pre><code><span><span class="va">air</span> <span class="op">&lt;-</span> <span class="va">res.mir</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">AIR</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">air</span><span class="op">)</span></span>
<span><span class="co">#        X1        X2        X3        X4        X5        X6 </span></span>
<span><span class="co">#  1.072849 13.133904 26.444900 19.155187 22.718355 20.782305 </span></span>
<span> </span>
<span><span class="va">res.mfi</span> <span class="op">&lt;-</span> <span class="va">res.mir</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">relations</span></span></code></pre>
<p><code>res.mfi</code> contains the results of <code><a href="reference/var.relations.mfi.html">var.relations.mfi()</a></code> conducted in MIR.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/AGSeifert/RFSurrogates/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RFSurrogates</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Stephan Seifert <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2567-5728" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Sven Gundlach <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-4060-2754" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Silke Szymczak <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-8897-9035" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Lukas C. Jarren <br><small class="roles"> Author </small>  </li>
<li>Florian Gärber <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-3875-9736" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stephan Seifert, Sven Gundlach, Silke Szymczak, Lukas C. Jarren, Florian Gärber.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
